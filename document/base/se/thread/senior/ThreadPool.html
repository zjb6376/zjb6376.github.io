<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>要点 | 个人主页</title>
    <meta name="description" content="小明爱挑食的博客">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.2db72707.css" as="style"><link rel="preload" href="/assets/js/app.5193439c.js" as="script"><link rel="preload" href="/assets/js/2.d78d7c4e.js" as="script"><link rel="preload" href="/assets/js/8.0b32f760.js" as="script"><link rel="prefetch" href="/assets/js/10.429f49f0.js"><link rel="prefetch" href="/assets/js/11.c3e1b8c4.js"><link rel="prefetch" href="/assets/js/12.59da75a0.js"><link rel="prefetch" href="/assets/js/13.bf138d81.js"><link rel="prefetch" href="/assets/js/14.b6030819.js"><link rel="prefetch" href="/assets/js/15.a9f40bdc.js"><link rel="prefetch" href="/assets/js/16.bf1e70e2.js"><link rel="prefetch" href="/assets/js/17.deb116b6.js"><link rel="prefetch" href="/assets/js/18.b8b45309.js"><link rel="prefetch" href="/assets/js/19.00eef20a.js"><link rel="prefetch" href="/assets/js/20.79fbe122.js"><link rel="prefetch" href="/assets/js/21.324574b3.js"><link rel="prefetch" href="/assets/js/22.3a8be460.js"><link rel="prefetch" href="/assets/js/23.9b5a6de8.js"><link rel="prefetch" href="/assets/js/24.e089aa02.js"><link rel="prefetch" href="/assets/js/25.809f7a68.js"><link rel="prefetch" href="/assets/js/26.8c2ceafc.js"><link rel="prefetch" href="/assets/js/27.17956208.js"><link rel="prefetch" href="/assets/js/28.cc5d8f9c.js"><link rel="prefetch" href="/assets/js/29.79e1cc6e.js"><link rel="prefetch" href="/assets/js/3.702c14f5.js"><link rel="prefetch" href="/assets/js/30.c9e15a2c.js"><link rel="prefetch" href="/assets/js/31.97c94daf.js"><link rel="prefetch" href="/assets/js/32.838140d4.js"><link rel="prefetch" href="/assets/js/33.b2b949fd.js"><link rel="prefetch" href="/assets/js/34.3a34ab1b.js"><link rel="prefetch" href="/assets/js/35.c028890d.js"><link rel="prefetch" href="/assets/js/36.a0cb3d07.js"><link rel="prefetch" href="/assets/js/37.0594a16c.js"><link rel="prefetch" href="/assets/js/38.57b55ea9.js"><link rel="prefetch" href="/assets/js/39.24f58851.js"><link rel="prefetch" href="/assets/js/4.e79f3fb9.js"><link rel="prefetch" href="/assets/js/40.5a904eda.js"><link rel="prefetch" href="/assets/js/41.bfca088c.js"><link rel="prefetch" href="/assets/js/42.d695032a.js"><link rel="prefetch" href="/assets/js/43.9bb7f76f.js"><link rel="prefetch" href="/assets/js/44.e477cee9.js"><link rel="prefetch" href="/assets/js/45.a35f1b1d.js"><link rel="prefetch" href="/assets/js/46.6102bb9b.js"><link rel="prefetch" href="/assets/js/47.eaafc616.js"><link rel="prefetch" href="/assets/js/48.ad251c91.js"><link rel="prefetch" href="/assets/js/49.c3a7199e.js"><link rel="prefetch" href="/assets/js/5.cf5a4471.js"><link rel="prefetch" href="/assets/js/50.e0634d3d.js"><link rel="prefetch" href="/assets/js/51.51a3bee7.js"><link rel="prefetch" href="/assets/js/52.2bf0fae2.js"><link rel="prefetch" href="/assets/js/53.226079e4.js"><link rel="prefetch" href="/assets/js/54.71a247f0.js"><link rel="prefetch" href="/assets/js/55.64c3325a.js"><link rel="prefetch" href="/assets/js/56.6c27a9ca.js"><link rel="prefetch" href="/assets/js/57.143512bd.js"><link rel="prefetch" href="/assets/js/58.4a9a86f3.js"><link rel="prefetch" href="/assets/js/59.941df235.js"><link rel="prefetch" href="/assets/js/6.f61929b7.js"><link rel="prefetch" href="/assets/js/60.3a5f3c91.js"><link rel="prefetch" href="/assets/js/61.91bed941.js"><link rel="prefetch" href="/assets/js/62.cf2aa19a.js"><link rel="prefetch" href="/assets/js/63.dbd3006f.js"><link rel="prefetch" href="/assets/js/64.edfdd7c2.js"><link rel="prefetch" href="/assets/js/65.e3a8c2d4.js"><link rel="prefetch" href="/assets/js/66.c762412b.js"><link rel="prefetch" href="/assets/js/67.ee856db4.js"><link rel="prefetch" href="/assets/js/68.ae3236b9.js"><link rel="prefetch" href="/assets/js/7.56e95b4c.js"><link rel="prefetch" href="/assets/js/9.01384073.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2db72707.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人主页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/base/se/" class="nav-link router-link-active">JavaSE</a></li><li class="dropdown-item"><!----> <a href="/document/base/ee/" class="nav-link">JavaEE</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/db/mysql/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/document/db/oracle/" class="nav-link">oracle</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/frame/ssm/" class="nav-link">ssm</a></li><li class="dropdown-item"><!----> <a href="/document/frame/springboot/" class="nav-link">springboot</a></li><li class="dropdown-item"><!----> <a href="/document/frame/springcloud/" class="nav-link">springcloud</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/middleware/redis/" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/document/middleware/mq/" class="nav-link">mq</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/tool/linux/" class="nav-link">linux</a></li><li class="dropdown-item"><!----> <a href="/document/tool/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/document/tool/idea/" class="nav-link">idea</a></li><li class="dropdown-item"><!----> <a href="/document/tool/install/" class="nav-link">工具安装</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">拓展</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/expand/jiagou/" class="nav-link">架构</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/base/se/" class="nav-link router-link-active">JavaSE</a></li><li class="dropdown-item"><!----> <a href="/document/base/ee/" class="nav-link">JavaEE</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">数据库</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/db/mysql/" class="nav-link">mysql</a></li><li class="dropdown-item"><!----> <a href="/document/db/oracle/" class="nav-link">oracle</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/frame/ssm/" class="nav-link">ssm</a></li><li class="dropdown-item"><!----> <a href="/document/frame/springboot/" class="nav-link">springboot</a></li><li class="dropdown-item"><!----> <a href="/document/frame/springcloud/" class="nav-link">springcloud</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/middleware/redis/" class="nav-link">redis</a></li><li class="dropdown-item"><!----> <a href="/document/middleware/mq/" class="nav-link">mq</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/tool/linux/" class="nav-link">linux</a></li><li class="dropdown-item"><!----> <a href="/document/tool/git/" class="nav-link">Git</a></li><li class="dropdown-item"><!----> <a href="/document/tool/idea/" class="nav-link">idea</a></li><li class="dropdown-item"><!----> <a href="/document/tool/install/" class="nav-link">工具安装</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">拓展</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/document/expand/jiagou/" class="nav-link">架构</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>常用类</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>字符串处理</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/document/base/se/toolclass/string/substring.html" class="sidebar-link">截取</a></li><li><a href="/document/base/se/toolclass/string/split.html" class="sidebar-link">分割</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>时间日期处理</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>计算精度处理</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>集合</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>IO流</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>多线程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络编程</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h4 id="要点"><a href="#要点" aria-hidden="true" class="header-anchor">#</a> 要点</h4> <ul><li>线程池的定义</li> <li>Executors创建线程池的几种方式</li> <li>ThreadPoolExecutor对象</li> <li>线程池执行任务逻辑和线程池参数的关系</li> <li>Executors创建返回ThreadPoolExecutor对象</li> <li>如何定义线程池参数</li></ul> <h4 id="使用线程池的优点"><a href="#使用线程池的优点" aria-hidden="true" class="header-anchor">#</a> 使用线程池的优点</h4> <p>减少资源创建、 降低系统开销、 提高稳定稳定性 （但需要避免内存溢出）</p> <h4 id="executors创建线程池的方式"><a href="#executors创建线程池的方式" aria-hidden="true" class="header-anchor">#</a> Executors创建线程池的方式</h4> <ul><li>创建返回ThreadPoolExecutor对象</li> <li>创建返回ScheduleThreadPoolExecutor对象</li> <li>创建返回ForkJoinPool对象</li></ul> <h4 id="threadpoolexecutor对象"><a href="#threadpoolexecutor对象" aria-hidden="true" class="header-anchor">#</a> ThreadPoolExecutor对象</h4> <p>在介绍<code>Executors</code>创建线程池方法前先介绍一下<code>ThreadPoolExecutor</code>，因为这些创建线程池的静态方法都是返回<code>ThreadPoolExecutor</code>对象，和我们手动创建<code>ThreadPoolExecutor</code>对象的区别就是我们不需要自己传构造函数的参数。<code>ThreadPoolExecutor</code>的构造函数共有四个，但最终调用的都是同一个：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span> <span class="token keyword">int</span> maximumPoolSize<span class="token punctuation">,</span> <span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">,</span> <span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span> workQueue<span class="token punctuation">,</span> <span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">,</span> <span class="token class-name">RejectedExecutionHandler</span> handler<span class="token punctuation">)</span>

</code></pre></div><ul><li><p>corePoolSize =&gt; 线程池核心线程数量</p></li> <li><p>maximumPoolSize =&gt; 线程池最大数量</p></li> <li><p>keepAliveTime =&gt; 空闲线程存活时间</p></li> <li><p>unit =&gt; 时间单位</p></li> <li><p>workQueue =&gt; 线程池所使用的缓冲队列</p></li> <li><p>threadFactory =&gt; 线程池创建线程使用的工厂</p></li> <li><p>handler =&gt; 线程池对拒绝任务的处理策略</p></li></ul> <p><img src="data:image/png;base64,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" alt="10"></p> <ul><li><p>判断核心线程数是否已满，核心线程数大小和<code>corePoolSize</code>参数有关，未满则创建线程执行任务</p></li> <li><p>若核心线程池已满，判断队列是否满，队列是否满和<code>workQueue</code>参数有关，若未满则加入队列中</p></li> <li><p>若队列已满，判断线程池是否已满，线程池是否已满和<code>maximumPoolSize</code>参数有关，若未满创建线程执行任务</p></li> <li><p>若线程池已满，则采用拒绝策略处理无法执执行的任务，拒绝策略和<code>handler</code>参数有关</p></li></ul> <p><code>Executors</code>创建返回ThreadPoolExecutor对象的方法共有三种：</p> <ol><li>Executors#newCachedThreadPool =&gt; 创建可缓存的线程池</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newCachedThreadPool</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">,</span> <span class="token number">60L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>SECONDS<span class="token punctuation">,</span>
                                  <span class="token keyword">new</span> <span class="token class-name">SynchronousQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>CachedThreadPool</code>是一个根据需要创建新线程的线程池</p> <ul><li>corePoolSize =&gt; 0，核心线程池的数量为0</li> <li>maximumPoolSize =&gt; Integer.MAX_VALUE，线程池最大数量为Integer.MAX_VALUE，可以认为可以无限创建线程</li> <li>keepAliveTime =&gt; 60L</li> <li>unit =&gt; 秒</li> <li>workQueue =&gt; SynchronousQueue</li></ul> <p>当一个任务提交时，<code>corePoolSize</code>为0不创建核心线程，<code>SynchronousQueue</code>是一个不存储元素的队列，可以理解为队里永远是满的，因此最终会创建非核心线程来执行任务。对于非核心线程空闲60s时将被回收。<strong>因为<code>Integer.MAX_VALUE</code>非常大，可以认为是可以无限创建线程的，在资源有限的情况下容易引起OOM异常</strong></p> <ol start="2"><li>Executors#newSingleThreadExecutor =&gt; 创建单线程的线程池</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newSingleThreadExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FinalizableDelegatedExecutorService</span>
        <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>SingleThreadExecutor</code>是单线程线程池，只有一个核心线程</p> <ul><li>corePoolSize =&gt; 1，核心线程池的数量为1</li> <li>maximumPoolSize =&gt; 1，线程池最大数量为1，即最多只可以创建一个线程，唯一的线程就是核心线程</li> <li>keepAliveTime =&gt; 0L</li> <li>unit =&gt; 毫秒</li> <li>workQueue =&gt; LinkedBlockingQueue</li></ul> <p>当一个任务提交时，首先会创建一个核心线程来执行任务，如果超过核心线程的数量，将会放入队列中，<strong>因为<code>LinkedBlockingQueue</code>是长度为<code>Integer.MAX_VALUE</code>的队列，可以认为是无界队列，因此往队列中可以插入无限多的任务，在资源有限的时候容易引起<code>OOM</code>异常</strong>，同时因为无界队列，<code>maximumPoolSize</code>和<code>keepAliveTime</code>参数将无效，压根就不会创建非核心线程。</p> <ol start="3"><li>Executors#newFixedThreadPool =&gt; 创建固定长度的线程池</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">ExecutorService</span> <span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token keyword">int</span> nThreads<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>nThreads<span class="token punctuation">,</span> nThreads<span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MILLISECONDS<span class="token punctuation">,</span>
                                  <span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>FixedThreadPool</code>是固定核心线程的线程池，固定核心线程数由用户传入</p> <ul><li>corePoolSize =&gt; nThreads，核心线程池的数量为1</li> <li>maximumPoolSize =&gt; nThreads，线程池最大数量为nThreads，即最多只可以创建nThreads个线程</li> <li>keepAliveTime =&gt; 0L</li> <li>unit =&gt; 毫秒</li> <li>workQueue =&gt; LinkedBlockingQueue 它和<code>SingleThreadExecutor</code>类似，唯一的区别就是核心线程数不同，并且由于<strong>使用的是<code>LinkedBlockingQueue</code>，在资源有限的时候容易引起<code>OOM</code>异常</strong></li></ul> <h4 id="如何定义线程池参数"><a href="#如何定义线程池参数" aria-hidden="true" class="header-anchor">#</a> 如何定义线程池参数</h4> <p><strong>CPU密集型</strong> =&gt; 线程池的大小推荐为<code>CPU</code>数量 + 1，<code>CPU</code>数量可以根据<code>Runtime.availableProcessors</code>方法获取</p> <p><strong>IO密集型</strong> =&gt; <code>CPU</code>数量 * <code>CPU</code>利用率 * (1 + 线程等待时间/线程CPU时间)</p> <p><strong>混合型</strong> =&gt; 将任务分为<code>CPU</code>密集型和<code>IO</code>密集型，然后分别使用不同的线程池去处理，从而使每个线程池可以根据各自的工作负载来调整</p> <p><strong>阻塞队列</strong> =&gt; 推荐使用有界队列，有界队列有助于避免资源耗尽的情况发生</p> <p><strong>拒绝策略</strong> =&gt; 默认采用的是拒绝策略，直接在程序中抛出异常【因为是运行时异常，不强制】，这种处理方式不够优雅。处理拒绝策略有以下几种比较推荐：</p> <ol><li><p>在程序中捕获<code>RejectedExecutionException</code>异常，在捕获异常中对任务进行处理。针对默认拒绝策略</p></li> <li><p>使用<code>CallerRunsPolicy</code>拒绝策略，该策略会将任务交给调用execute的线程执行【一般为主线程】，此时主线程将在一段时间内不能提交任何任务，从而使工作线程处理正在执行的任务。此时提交的线程将被保存在<code>TCP</code>队列中，TCP队列满将会影响客户端，这是一种平缓的性能降低</p></li> <li><p>自定义拒绝策略，只需要实现<code>RejectedExecutionHandler</code>接口即可</p></li> <li><p>如果任务不是特别重要，使用<code>DiscardPolicy</code>和<code>DiscardOldestPolicy</code>拒绝策略将任务丢弃也是可以的</p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/document/base/se/thread/primary/ThreadLocal.html" class="prev">
          对ThreadLocal的理解
        </a></span> <span class="next"><a href="/document/base/se/thread/senior/future.html">
          多线程异步执行
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.5193439c.js" defer></script><script src="/assets/js/2.d78d7c4e.js" defer></script><script src="/assets/js/8.0b32f760.js" defer></script>
  </body>
</html>
